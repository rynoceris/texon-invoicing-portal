{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./EmailModal.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_BASE='/texon-invoicing-portal/api';const EmailModal=_ref=>{var _orderData$billingCon3,_orderData$customer3;let{isOpen,invoice,emailType,onClose,onSend,token}=_ref;const[emailData,setEmailData]=useState({to:'',subject:'',body:'',emailType:emailType});const[isLoading,setIsLoading]=useState(false);const[lastSent,setLastSent]=useState(null);const[emailHistory,setEmailHistory]=useState([]);const orderData=invoice||{};// Debug logging to see what data we're receiving\nuseEffect(()=>{if(isOpen){console.log('EmailModal orderData:',orderData);}},[isOpen,orderData]);useEffect(()=>{if(isOpen&&orderData.id){loadEmailTemplate();loadLastSentInfo();}},[isOpen,orderData,emailType]);const loadEmailTemplate=async()=>{var _orderData$billingCon,_orderData$customer,_orderData$deliveryCo;// Get recipient email\nconst recipientEmail=((_orderData$billingCon=orderData.billingContact)===null||_orderData$billingCon===void 0?void 0:_orderData$billingCon.email)||((_orderData$customer=orderData.customer)===null||_orderData$customer===void 0?void 0:_orderData$customer.email)||((_orderData$deliveryCo=orderData.deliveryContact)===null||_orderData$deliveryCo===void 0?void 0:_orderData$deliveryCo.email)||'';try{// Get template from backend\nconst response=await fetch(`${API_BASE}/email-template/${emailType}`,{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(response.ok){var _orderData$billingCon2,_orderData$customer2;const template=await response.json();// Replace template variables\nconst templateVars={ORDER_ID:orderData.id,CUSTOMER_NAME:((_orderData$billingCon2=orderData.billingContact)===null||_orderData$billingCon2===void 0?void 0:_orderData$billingCon2.name)||((_orderData$customer2=orderData.customer)===null||_orderData$customer2===void 0?void 0:_orderData$customer2.name)||'Valued Customer',COMPANY_NAME:'Texon Towel',ORDER_REFERENCE:orderData.orderRef||orderData.reference||'',INVOICE_NUMBER:orderData.invoiceNumber||'',TOTAL_AMOUNT:orderData.totalAmount?`$${orderData.totalAmount}`:'',DAYS_OUTSTANDING:orderData.days_outstanding||'',PAYMENT_LINK:orderData.paymentLink||''};const subject=replaceTemplateVars(template.subject_template,templateVars);const body=replaceTemplateVars(template.body_template,templateVars);setEmailData({to:recipientEmail,subject:subject,body:body,emailType:emailType});}else{// Fallback default template\nsetDefaultTemplate(recipientEmail);}}catch(error){console.error('Error loading email template:',error);setDefaultTemplate(recipientEmail);}};const setDefaultTemplate=recipientEmail=>{const isReminder=emailType==='reminder';setEmailData({to:recipientEmail,subject:isReminder?`Payment Reminder - Order #${orderData.id}`:`Invoice - Order #${orderData.id}`,body:isReminder?`Dear ${orderData.billingaddressfullname||'Valued Customer'},\\n\\nThis is a friendly reminder that payment is due for Order #${orderData.id}.\\n\\nOrder Total: $${orderData.total||orderData.totalvalue||'0.00'}\\nOrder Date: ${new Date(orderData.placedon).toLocaleDateString()}\\n\\nPlease submit payment at your earliest convenience.\\n\\nBest regards,\\nTexon Towel`:`Dear ${orderData.billingaddressfullname||'Valued Customer'},\\n\\nThank you for your order. Please find your invoice attached.\\n\\nOrder #: ${orderData.id}\\nTotal Amount: $${orderData.total||orderData.totalvalue||'0.00'}\\n\\nBest regards,\\nTexon Towel`,emailType:emailType});};const replaceTemplateVars=(template,variables)=>{let result=template||'';for(const[key,value]of Object.entries(variables)){const placeholder=`{${key}}`;result=result.replace(new RegExp(placeholder,'g'),value||'');}return result;};const loadLastSentInfo=async()=>{try{const response=await fetch(`${API_BASE}/email-logs/order/${orderData.id}`,{headers:{'Authorization':`Bearer ${token}`}});if(response.ok){const logs=await response.json();if(logs&&logs.length>0){// Find the most recent email of this type\nconst recentEmail=logs.find(log=>log.email_type===emailType);if(recentEmail){setLastSent({date:new Date(recentEmail.created_at).toLocaleString(),status:recentEmail.send_status,recipient:recentEmail.recipient_email});}setEmailHistory(logs.filter(log=>log.email_type===emailType).slice(0,5));}}}catch(error){console.error('Error loading email history:',error);}};const handleSend=async()=>{if(!emailData.to||!emailData.subject||!emailData.body){alert('Please fill in all required fields.');return;}setIsLoading(true);try{const success=await onSend({orderId:orderData.id,to:emailData.to,subject:emailData.subject,body:emailData.body,emailType:emailType});if(success){onClose();}}catch(error){console.error('Error sending email:',error);alert('Failed to send email: '+error.message);}finally{setIsLoading(false);}};const handleInputChange=(field,value)=>{setEmailData(prev=>({...prev,[field]:value}));};if(!isOpen)return null;const isReminder=emailType==='reminder';return/*#__PURE__*/_jsx(\"div\",{className:\"email-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"email-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"email-modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[isReminder?'‚ö†Ô∏è Send Payment Reminder':'üìß Send Invoice',\" - Order #\",orderData.id]}),/*#__PURE__*/_jsx(\"button\",{className:\"email-modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"email-modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Order Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-details\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Customer:\"}),\" \",((_orderData$billingCon3=orderData.billingContact)===null||_orderData$billingCon3===void 0?void 0:_orderData$billingCon3.name)||((_orderData$customer3=orderData.customer)===null||_orderData$customer3===void 0?void 0:_orderData$customer3.name)||orderData.billingaddressfullname||orderData.customerName||'N/A']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Amount:\"}),\" $\",orderData.totalAmount||orderData.total||orderData.totalvalue||orderData.amount||'0.00']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",orderData.orderDate?new Date(orderData.orderDate).toLocaleDateString():orderData.placedon?new Date(orderData.placedon).toLocaleDateString():orderData.invoiceDate?new Date(orderData.invoiceDate).toLocaleDateString():'Invalid Date']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Days Outstanding:\"}),\" \",orderData.days_outstanding||orderData.daysOutstanding||orderData.outstanding_days||'N/A']})]})]}),lastSent&&/*#__PURE__*/_jsxs(\"div\",{className:\"last-sent-info\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Last \",isReminder?'Reminder':'Invoice',\" Sent\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",lastSent.date,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" Status:\"}),\" \",lastSent.status,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" To:\"}),\" \",lastSent.recipient]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"email-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"To: *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:emailData.to,onChange:e=>handleInputChange('to',e.target.value),placeholder:\"customer@example.com\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Subject: *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:emailData.subject,onChange:e=>handleInputChange('subject',e.target.value),placeholder:\"Email subject...\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Message: *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:emailData.body,onChange:e=>handleInputChange('body',e.target.value),placeholder:\"Email message...\",rows:\"8\",required:true})]})]}),emailHistory.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"email-history\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Recent \",isReminder?'Reminders':'Invoices']}),/*#__PURE__*/_jsx(\"div\",{className:\"history-list\",children:emailHistory.map((log,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"history-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"history-date\",children:new Date(log.created_at).toLocaleDateString()}),/*#__PURE__*/_jsx(\"span\",{className:`history-status ${log.send_status}`,children:log.send_status}),/*#__PURE__*/_jsx(\"span\",{className:\"history-recipient\",children:log.recipient_email})]},index))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"email-modal-footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:onClose,disabled:isLoading,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleSend,disabled:isLoading||!emailData.to||!emailData.subject||!emailData.body,children:isLoading?isReminder?'Sending Reminder...':'Sending Invoice...':isReminder?'‚ö†Ô∏è Send Reminder':'üìß Send Invoice'})]})})]})});};export default EmailModal;","map":{"version":3,"names":["React","useState","useEffect","jsxs","_jsxs","jsx","_jsx","API_BASE","EmailModal","_ref","_orderData$billingCon3","_orderData$customer3","isOpen","invoice","emailType","onClose","onSend","token","emailData","setEmailData","to","subject","body","isLoading","setIsLoading","lastSent","setLastSent","emailHistory","setEmailHistory","orderData","console","log","id","loadEmailTemplate","loadLastSentInfo","_orderData$billingCon","_orderData$customer","_orderData$deliveryCo","recipientEmail","billingContact","email","customer","deliveryContact","response","fetch","headers","localStorage","getItem","ok","_orderData$billingCon2","_orderData$customer2","template","json","templateVars","ORDER_ID","CUSTOMER_NAME","name","COMPANY_NAME","ORDER_REFERENCE","orderRef","reference","INVOICE_NUMBER","invoiceNumber","TOTAL_AMOUNT","totalAmount","DAYS_OUTSTANDING","days_outstanding","PAYMENT_LINK","paymentLink","replaceTemplateVars","subject_template","body_template","setDefaultTemplate","error","isReminder","billingaddressfullname","total","totalvalue","Date","placedon","toLocaleDateString","variables","result","key","value","Object","entries","placeholder","replace","RegExp","logs","length","recentEmail","find","email_type","date","created_at","toLocaleString","status","send_status","recipient","recipient_email","filter","slice","handleSend","alert","success","orderId","message","handleInputChange","field","prev","className","onClick","children","e","stopPropagation","customerName","amount","orderDate","invoiceDate","daysOutstanding","outstanding_days","type","onChange","target","required","rows","map","index","disabled"],"sources":["/home/collegesportsdir/public_html/texon-invoicing-portal/client/src/EmailModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './EmailModal.css';\n\nconst API_BASE = '/texon-invoicing-portal/api';\n\nconst EmailModal = ({ isOpen, invoice, emailType, onClose, onSend, token }) => {\n    const [emailData, setEmailData] = useState({\n        to: '',\n        subject: '',\n        body: '',\n        emailType: emailType\n    });\n    const [isLoading, setIsLoading] = useState(false);\n    const [lastSent, setLastSent] = useState(null);\n    const [emailHistory, setEmailHistory] = useState([]);\n    \n    const orderData = invoice || {};\n    \n    // Debug logging to see what data we're receiving\n    useEffect(() => {\n        if (isOpen) {\n            console.log('EmailModal orderData:', orderData);\n        }\n    }, [isOpen, orderData]);\n    \n    useEffect(() => {\n        if (isOpen && orderData.id) {\n            loadEmailTemplate();\n            loadLastSentInfo();\n        }\n    }, [isOpen, orderData, emailType]);\n\n    const loadEmailTemplate = async () => {\n        // Get recipient email\n        const recipientEmail = orderData.billingContact?.email || orderData.customer?.email || orderData.deliveryContact?.email || '';\n        \n        try {\n            // Get template from backend\n            const response = await fetch(`${API_BASE}/email-template/${emailType}`, {\n                headers: {\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`\n                }\n            });\n            \n            if (response.ok) {\n                const template = await response.json();\n                \n                // Replace template variables\n                const templateVars = {\n                    ORDER_ID: orderData.id,\n                    CUSTOMER_NAME: orderData.billingContact?.name || orderData.customer?.name || 'Valued Customer',\n                    COMPANY_NAME: 'Texon Towel',\n                    ORDER_REFERENCE: orderData.orderRef || orderData.reference || '',\n                    INVOICE_NUMBER: orderData.invoiceNumber || '',\n                    TOTAL_AMOUNT: orderData.totalAmount ? `$${orderData.totalAmount}` : '',\n                    DAYS_OUTSTANDING: orderData.days_outstanding || '',\n                    PAYMENT_LINK: orderData.paymentLink || ''\n                };\n\n                const subject = replaceTemplateVars(template.subject_template, templateVars);\n                const body = replaceTemplateVars(template.body_template, templateVars);\n\n                setEmailData({\n                    to: recipientEmail,\n                    subject: subject,\n                    body: body,\n                    emailType: emailType\n                });\n            } else {\n                // Fallback default template\n                setDefaultTemplate(recipientEmail);\n            }\n        } catch (error) {\n            console.error('Error loading email template:', error);\n            setDefaultTemplate(recipientEmail);\n        }\n    };\n\n    const setDefaultTemplate = (recipientEmail) => {\n        const isReminder = emailType === 'reminder';\n        \n        setEmailData({\n            to: recipientEmail,\n            subject: isReminder \n                ? `Payment Reminder - Order #${orderData.id}` \n                : `Invoice - Order #${orderData.id}`,\n            body: isReminder \n                ? `Dear ${orderData.billingaddressfullname || 'Valued Customer'},\\n\\nThis is a friendly reminder that payment is due for Order #${orderData.id}.\\n\\nOrder Total: $${orderData.total || orderData.totalvalue || '0.00'}\\nOrder Date: ${new Date(orderData.placedon).toLocaleDateString()}\\n\\nPlease submit payment at your earliest convenience.\\n\\nBest regards,\\nTexon Towel` \n                : `Dear ${orderData.billingaddressfullname || 'Valued Customer'},\\n\\nThank you for your order. Please find your invoice attached.\\n\\nOrder #: ${orderData.id}\\nTotal Amount: $${orderData.total || orderData.totalvalue || '0.00'}\\n\\nBest regards,\\nTexon Towel`,\n            emailType: emailType\n        });\n    };\n\n    const replaceTemplateVars = (template, variables) => {\n        let result = template || '';\n        for (const [key, value] of Object.entries(variables)) {\n            const placeholder = `{${key}}`;\n            result = result.replace(new RegExp(placeholder, 'g'), value || '');\n        }\n        return result;\n    };\n\n    const loadLastSentInfo = async () => {\n        try {\n            const response = await fetch(`${API_BASE}/email-logs/order/${orderData.id}`, {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            });\n            \n            if (response.ok) {\n                const logs = await response.json();\n                if (logs && logs.length > 0) {\n                    // Find the most recent email of this type\n                    const recentEmail = logs.find(log => log.email_type === emailType);\n                    if (recentEmail) {\n                        setLastSent({\n                            date: new Date(recentEmail.created_at).toLocaleString(),\n                            status: recentEmail.send_status,\n                            recipient: recentEmail.recipient_email\n                        });\n                    }\n                    setEmailHistory(logs.filter(log => log.email_type === emailType).slice(0, 5));\n                }\n            }\n        } catch (error) {\n            console.error('Error loading email history:', error);\n        }\n    };\n\n    const handleSend = async () => {\n        if (!emailData.to || !emailData.subject || !emailData.body) {\n            alert('Please fill in all required fields.');\n            return;\n        }\n\n        setIsLoading(true);\n        \n        try {\n            const success = await onSend({\n                orderId: orderData.id,\n                to: emailData.to,\n                subject: emailData.subject,\n                body: emailData.body,\n                emailType: emailType\n            });\n            \n            if (success) {\n                onClose();\n            }\n        } catch (error) {\n            console.error('Error sending email:', error);\n            alert('Failed to send email: ' + error.message);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const handleInputChange = (field, value) => {\n        setEmailData(prev => ({\n            ...prev,\n            [field]: value\n        }));\n    };\n\n    if (!isOpen) return null;\n\n    const isReminder = emailType === 'reminder';\n\n    return (\n        <div className=\"email-modal-overlay\" onClick={onClose}>\n            <div className=\"email-modal\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"email-modal-header\">\n                    <h2>\n                        {isReminder ? '‚ö†Ô∏è Send Payment Reminder' : 'üìß Send Invoice'} - Order #{orderData.id}\n                    </h2>\n                    <button className=\"email-modal-close\" onClick={onClose}>√ó</button>\n                </div>\n                \n                <div className=\"email-modal-content\">\n                    {/* Order Info */}\n                    <div className=\"order-info\">\n                        <h4>Order Details</h4>\n                        <div className=\"order-details\">\n                            <span><strong>Customer:</strong> {\n                                orderData.billingContact?.name || \n                                orderData.customer?.name || \n                                orderData.billingaddressfullname || \n                                orderData.customerName || \n                                'N/A'\n                            }</span>\n                            <span><strong>Amount:</strong> ${\n                                orderData.totalAmount || \n                                orderData.total || \n                                orderData.totalvalue || \n                                orderData.amount ||\n                                '0.00'\n                            }</span>\n                            <span><strong>Date:</strong> {\n                                orderData.orderDate ? \n                                    new Date(orderData.orderDate).toLocaleDateString() :\n                                orderData.placedon ? \n                                    new Date(orderData.placedon).toLocaleDateString() :\n                                orderData.invoiceDate ? \n                                    new Date(orderData.invoiceDate).toLocaleDateString() :\n                                    'Invalid Date'\n                            }</span>\n                            <span><strong>Days Outstanding:</strong> {\n                                orderData.days_outstanding || \n                                orderData.daysOutstanding || \n                                orderData.outstanding_days || \n                                'N/A'\n                            }</span>\n                        </div>\n                    </div>\n\n                    {/* Last Sent Info */}\n                    {lastSent && (\n                        <div className=\"last-sent-info\">\n                            <h4>Last {isReminder ? 'Reminder' : 'Invoice'} Sent</h4>\n                            <p>\n                                <strong>Date:</strong> {lastSent.date} | \n                                <strong> Status:</strong> {lastSent.status} | \n                                <strong> To:</strong> {lastSent.recipient}\n                            </p>\n                        </div>\n                    )}\n\n                    {/* Email Form */}\n                    <div className=\"email-form\">\n                        <div className=\"form-group\">\n                            <label>To: *</label>\n                            <input\n                                type=\"email\"\n                                value={emailData.to}\n                                onChange={(e) => handleInputChange('to', e.target.value)}\n                                placeholder=\"customer@example.com\"\n                                required\n                            />\n                        </div>\n                        \n                        <div className=\"form-group\">\n                            <label>Subject: *</label>\n                            <input\n                                type=\"text\"\n                                value={emailData.subject}\n                                onChange={(e) => handleInputChange('subject', e.target.value)}\n                                placeholder=\"Email subject...\"\n                                required\n                            />\n                        </div>\n                        \n                        <div className=\"form-group\">\n                            <label>Message: *</label>\n                            <textarea\n                                value={emailData.body}\n                                onChange={(e) => handleInputChange('body', e.target.value)}\n                                placeholder=\"Email message...\"\n                                rows=\"8\"\n                                required\n                            />\n                        </div>\n                    </div>\n\n                    {/* Email History */}\n                    {emailHistory.length > 0 && (\n                        <div className=\"email-history\">\n                            <h4>Recent {isReminder ? 'Reminders' : 'Invoices'}</h4>\n                            <div className=\"history-list\">\n                                {emailHistory.map((log, index) => (\n                                    <div key={index} className=\"history-item\">\n                                        <span className=\"history-date\">\n                                            {new Date(log.created_at).toLocaleDateString()}\n                                        </span>\n                                        <span className={`history-status ${log.send_status}`}>\n                                            {log.send_status}\n                                        </span>\n                                        <span className=\"history-recipient\">\n                                            {log.recipient_email}\n                                        </span>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n                </div>\n                \n                <div className=\"email-modal-footer\">\n                    <div className=\"modal-buttons\">\n                        <button\n                            className=\"btn-secondary\"\n                            onClick={onClose}\n                            disabled={isLoading}\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            className=\"btn-primary\"\n                            onClick={handleSend}\n                            disabled={isLoading || !emailData.to || !emailData.subject || !emailData.body}\n                        >\n                            {isLoading \n                                ? (isReminder ? 'Sending Reminder...' : 'Sending Invoice...') \n                                : (isReminder ? '‚ö†Ô∏è Send Reminder' : 'üìß Send Invoice')\n                            }\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default EmailModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}